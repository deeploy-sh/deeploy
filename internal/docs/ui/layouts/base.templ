package layouts

import (
	"fmt"
	"github.com/deeploy-sh/deeploy/internal/docs/config"
	"time"
)

templ BaseLayout() {
	<!DOCTYPE html>
	<html lang="en">
		<head>
			<meta charset="UTF-8"/>
			<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
			<title>deeploy - The open source deployment platform</title>
			<meta name="description" content="Terminal-first deployment platform. Built for developers who live in the command line."/>
			<!-- Favicon -->
			<link rel="icon" type="image/svg+xml" href="/assets/img/favicon.svg"/>
			// Preload fonts to prevent flickering
			<link rel="preload" href="/assets/fonts/jetbrains-mono/JetBrainsMono-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous"/>
			<link rel="preload" href="/assets/fonts/jetbrains-mono/JetBrainsMono-SemiBold.woff2" as="font" type="font/woff2" crossorigin="anonymous"/>
			// Tailwind CSS
			<link href={ templ.SafeURL("/assets/css/output.css?v=" + fmt.Sprint(time.Now().Unix())) } rel="stylesheet"/>
			// Theme initialization - must run before body renders to prevent flash
			<script nonce={ templ.GetNonce(ctx) }>
				(function() {
					const pref = localStorage.getItem('themePreference');
					// Default to dark, only go light if explicitly set
					if (pref !== 'light') {
						document.documentElement.classList.add('dark');
					}
				})();
			</script>
			// Plausible
			if config.AppConfig.IsProduction() {
				<script defer data-domain="deeploy.sh" src="https://plausible.axeladrian.com/js/script.js" nonce={ templ.GetNonce(ctx) }></script>
			}
		</head>
		<body class="font-mono antialiased">
			{ children... }
		</body>
	</html>
}
